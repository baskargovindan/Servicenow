<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sys_ui_page">
    <sys_ui_page action="INSERT_OR_UPDATE">
        <category>general</category>
        <client_script><![CDATA[/*
function applyNamingFormat()
{
	var logonName = $j("#firstNameInput").val()+$j("#lastNameInput").val();
	$j("#logonNameInput").val(logonName);
	$j("#logonNamePreWindowsInput").val(logonName);
}

function loadTemplate(templateList)
{
	templateList = templateList.evalJSON();
	var html = "<span style=\"font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;color: #000000;text-decoration:none;\">Selected Template: </span><select style=\"width: 250px; visibility: visible;\" name=\"TEMPLATE_DOMAIN_NAME\" id=\"TEMPLATE_NAME\">";

	for(var i=0; i<templateList.length;i++)
	{
		html = html+"<option value=\""+templateList[i]+"\">"+templateList[i]+"</option>";
	}
	html = html+"</select>";
	$j("#templateListDropDown").html(html);
}
function constructRequestDetails()
{
	var templateName = $j("#TEMPLATE_NAME").val();
	var domainName = $j("#DOMAIN_NAME").val();
	var firstname = $j("#firstNameInput").val();
	var lastName = $j("#lastNameInput").val();
	var logonName = $j("#logonNameInput").val();
	var logonnamePreWindows = $j("#logonNamePreWindowsInput").val();
	var password = $j("#passwordInput").val();
	var email = $j("#emailInput").val();
	var mobileNumber = $j("#mobileInput").val();
	var telephoneNumber = $j("#telephoneInput").val();
	var jobTitle = $j("#titleInput").val();


	var requestDetails = {};
	requestDetails.TemplateName = templateName;
	requestDetails.DomainName =domainName;
	requestDetails.FirstName = firstname;
	requestDetails.LastName = lastName;
	requestDetails.LogonName = logonName;
	requestDetails.LogonNamePreWindows = logonnamePreWindows;
	requestDetails.Password = password;
	requestDetails.Email = email;
	requestDetails.MobileNumber = mobileNumber;
	requestDetails.TelephoneNumber = telephoneNumber;
	requestDetails.JobTitle = jobTitle;
	requestDetails = JSON.stringify(requestDetails);
	return requestDetails;
}
function loadData(formData)
{
	$j("#TEMPLATE_NAME").val(formData.TemplateName?formData.TemplateName:'');
	$j("#DOMAIN_NAME").val(formData.DomainName?formData.DomainName:'');
	$j("#firstNameInput").val(formData.FirstName?formData.FirstName:'');
	$j("#lastNameInput").val(formData.LastName?formData.LastName:'');
	$j("#logonNameInput").val(formData.LogonName?formData.LogonName:'');
	$j("#logonNamePreWindowsInput").val(formData.LogonNamePreWindows?formData.LogonNamePreWindows:'');
	$j("#passwordInput").val(formData.Password?formData.Password:'');
	$j("#emailInput").val(formData.Email?formData.Email:'');
	$j("#mobileInput").val(formData.MobileNumber?formData.MobileNumber:'');
	$j("#telephoneInput").val(formData.TelephoneNumber?formData.TelephoneNumber:'');
	$j("#titleInput").val(formData.JobTitle?formData.JobTitle:'');
}

function getDomainName()
{
	return $j("#DOMAIN_NAME").val();
}

function getUserData()
{
	var userList = [];
	var userDetails = {};
	userDetails.givenName = $j("#firstNameInput").val();
	userDetails.sn = $j("#lastNameInput").val();
	userDetails.userPrincipalName = $j("#logonNameInput").val();
	userDetails.sAMAccountName = $j("#logonNamePreWindowsInput").val();
	userDetails.password = $j("#passwordInput").val();
	userDetails.mail = $j("#emailInput").val();
	userDetails.mobile = $j("#mobileInput").val();
	userDetails.telephoneNumber = $j("#telephoneInput").val();
	userDetails.title = $j("#titleInput").val();
	userDetails.templateName = $j("#TEMPLATE_NAME").val();
	userList.push(userDetails);
	return JSON.stringify(userList);
}

function displayResult(result)
{
	var html = "<table width=\"99%\" height=\"80\" align=\"center\" style=\"font-size: 11px;text-align: center;font-weight: bold;border:1px solid #60a2e2;border-bottom:none;background:#BFDBF6;color:#16428b;\"><tr><td  align=\"center\"><span style=\"font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;text-decoration:none;\">"+result[0].statusMessage+"</span></td></tr><tr><td align=\"center\"> USER NAME : "+result[0].LOG_ON_NAME+"</td><td align=\"center\">PASSWORD : *****</td></tr>";
	$j("#statusMessage").html(html);	
}

*/
]]></client_script>
        <description>Create a User in AD</description>
        <direct>false</direct>
        <endpoint>x_96574_admanager_Create a User in AD.do</endpoint>
        <html><![CDATA[<!-- <?xml version="1.0" encoding="utf-8" ?>
<j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null">
	<script language="javascript" src="service.sn-glideAjax.jsdbx" />

	<g:evaluate var="jvar_domainList" jelly="true" object="true">  
		var domainList = [];
		var domainGr = new GlideRecord('x_96574_admanager_admpdomaindetails');  
		domainGr.query();  
		while (domainGr.next()){  
		domainList.push(domainGr.domain_name.toString());
		}   
		domainList;
	</g:evaluate>
	<j:forEach items="${jvar_templateList}" var="jvar_template" indexVar="jvar_idx">  
		<span> ${jvar_template}</span>
	</j:forEach> 
	<link href="cf25abc4dbce7200208572ffbf961906.cssdbx" rel="stylesheet" type="text/css"></link>
	<div id = "statusMessage"  align="center" style = "border-bottom:20px">
	</div>
	<table width="99%" height="20px" border="0" align="center" cellpadding="10" cellspacing="0">

		<tr>
			<td align="center"><span style="font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;color: #000000;text-decoration:none;">Selected Domain: </span><select style="width: 250px; visibility: visible;" name="TEMPLATE_DOMAIN_NAME" id="DOMAIN_NAME" > 
				<j:forEach items="${jvar_domainList}" var="jvar_domain" indexVar="jvar_idx">  
					<option value="${jvar_domain}">${jvar_domain}</option>
				</j:forEach> 
				</select></td>
			<td align="center">
				<div id="templateListDropDown">
					<span style="font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;color: #000000;text-decoration:none;">Selected Template: </span><select style="width: 250px; visibility: visible;" name="TEMPLATE_DOMAIN_NAME" id="TEMPLATE_NAME">
					</select>
				</div></td>
		</tr>
	</table>

	<table id="mainContent" width="99%" align="center" border="1" bordercolor="#BFDBF6" cellpadding="10" cellspacing="0" style="margin-top:10px;margin-bottom:10px;">
		<tbody>

			<tr id="GroupHeaderRow" style="height: 25px;">
				<td colspan="2" style="font-family: Verdana, Arial, Helvetica, sans-serif;font-size: 11px;text-align: left;padding-left:5px;font-weight: bold;border:1px solid #60a2e2;border-bottom:none;background:#BFDBF6;color:#16428b;padding:0;" valign="top">
					<span id="fieldGroupName_83" ondblclick="" style="font-size: 12px">General</span>

				</td>
			</tr>
			<tr>
				<td>

					<table width="98%" border="0" cellpadding="10" cellspacing="0">
						<tr style="height: 40px; width:10px;">
							<td style="padding: 10px;" >
								<label id="firstNameLabel" style="cursor: default;"> <span  style="display:inline-block; width:200px;">First name </span>                            </label>
								<input type="text" style="width: 210px; color: rgb(143, 143, 143);" title="" id="firstNameInput" value="" greytext="" onblur="applyNamingFormat(this);" />
							</td>
						</tr>
						<tr style="height: 40px;">
							<td style="padding: 10px;" >
								<label id="lastNameLabel" style="cursor: default;"><span  style="display:inline-block; width:200px;">Last name</span></label>
								<input type="text" style="width: 210px; color: rgb(143, 143, 143);" title="" id="lastNameInput" value="" greytext="" onblur="applyNamingFormat(this);" />
							</td>
						</tr>
						<tr style="height: 40px;">
							<td style="padding: 10px;" >
								<label id="logonNameLabel" style="cursor: default;"><span  style="display:inline-block; width:200px;">Logon name               </span></label>
								<input type="text" style="width: 210px; color: rgb(143, 143, 143);" title="" id="logonNameInput" value="" greytext=""/>
							</td>
						</tr>
						<tr style="height: 40px;">
							<td style="padding: 10px;" >
								<label id="logonNamePreWindowsLabel" style="cursor: default;"><span  style="display:inline-block; width:200px;">Logon name(pre-Windows 2000)</span></label>
								<input type="text" style="width: 210px; color: rgb(143, 143, 143);" title="" id="logonNamePreWindowsInput" value=""/>
							</td>
						</tr>
						<tr style="height: 40px;">
							<td style="padding: 10px;" >
								<label id="passwordLabel" style="cursor: default;"><span  style="display:inline-block; width:200px;">Password</span></label>
								<input type="password" style="width: 210px; color: rgb(143, 143, 143);" title="" id="passwordInput" value="" greytext=""/>
							</td>
						</tr>
						<tr style="height: 40px;">
							<td style="padding: 10px;" >
								<label id="emailLabel" style="cursor: default;"><span  style="display:inline-block; width:200px;">E-Mail</span></label>
								<input type="text" style="width: 210px; color: rgb(143, 143, 143);" title="" id="emailInput" value="" greytext="" />
							</td>
						</tr>
						<tr style="height: 40px;">
							<td style="padding: 10px;" >
								<label id="mobileLabel" style="cursor: default;"><span  style="display:inline-block; width:200px;">Mobile Number</span></label>
								<input type="text" style="width: 210px; color: rgb(143, 143, 143);" title="" id="mobileInput" value="" greytext=""/>
							</td>
						</tr>
						<tr style="height: 40px;">
							<td style="padding: 10px;" >
								<label id="telephoneLabel" style="cursor: default;"><span  style="display:inline-block; width:200px;">Telephone Number</span></label>
								<input type="text" style="width: 210px; color: rgb(143, 143, 143);" title="" id="telephoneInput" value="" greytext=""/>
							</td>
						</tr>
						<tr style="height: 40px;">
							<td style="padding: 10px;" >
								<label id="titleLabel" style="cursor: default;"><span  style="display:inline-block; width:200px;">Job Title</span></label>
								<input type="text" style="width: 210px; color: rgb(143, 143, 143);" title="" id="titleInput" value="" greytext=""/>
							</td>
						</tr>



					</table>


				</td>
			</tr>
		</tbody>
	</table>
</j:jelly> -->]]></html>
        <name>Create a User in AD</name>
        <processing_script/>
        <sys_class_name>sys_ui_page</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2017-04-05 16:34:02</sys_created_on>
        <sys_customer_update>true</sys_customer_update>
        <sys_id>bcc4c080dbca7200208572ffbf96195d</sys_id>
        <sys_mod_count>204</sys_mod_count>
        <sys_name>Create a User in AD</sys_name>
        <sys_package display_value="ADManager Plus" source="x_96574_admanager">fa4b5c44db397200208572ffbf961935</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="ADManager Plus">fa4b5c44db397200208572ffbf961935</sys_scope>
        <sys_update_name>sys_ui_page_bcc4c080dbca7200208572ffbf96195d</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2017-04-11 16:28:17</sys_updated_on>
    </sys_ui_page>
</record_update>
